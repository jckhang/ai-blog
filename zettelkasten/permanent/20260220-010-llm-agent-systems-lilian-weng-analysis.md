---
id: 20260220-010-llm-agent-systems-lilian-weng-analysis
title: LLM Agentç³»ç»Ÿæ¶æ„åˆ†æï¼ˆåŸºäºLilian Wengï¼‰
created: 2026-02-20
tags: ["agent", "llm-agent", "architecture", "planning", "memory", "tool-use", "multi-agent"]
source: "Lilian Weng Blog (2024-11-28) - Agent Systems"
source_url: "https://lilianweng.github.io/posts/2023-06-23-agent/"
content_length: 2800
quality_score: 0.88
related_notes: ["20260220-002-llm-powered-autonomous-agents", "20260220-009-step3-vl-10b-architecture-deep-dive"]
---

# LLM Agentç³»ç»Ÿæ¶æ„åˆ†æï¼ˆLilian Wengï¼‰

> **Agent â‰  Chain-of-Thought**: Agentèƒ½ä½¿ç”¨å·¥å…·ã€ä¸ç¯å¢ƒäº¤äº’ã€å¤šæ­¥æ¨ç†
> **æ ¸å¿ƒç»„ä»¶**: è§„åˆ’ï¼ˆPlanningï¼‰+ è®°å¿†ï¼ˆMemoryï¼‰+ å·¥å…·ä½¿ç”¨ï¼ˆTool Useï¼‰+ å¤šAgentåä½œ
> **åº”ç”¨**: AutoGPT, BabyAGI, LangChain, æ™ºèƒ½ä½“ç®—æ³•

---

## ğŸ¯ Agentå®šä¹‰ä¸èƒ½åŠ›

**LLMä½œä¸ºAgent** = è¶…å‚æ•°ï¼šAgentå…·å¤‡ä»¥ä¸‹èƒ½åŠ›ï¼š
1. âœ‹ **ä¸»åŠ¨è§„åˆ’**: å°†ä»»åŠ¡åˆ†è§£ä¸ºå­ä»»åŠ¡åºåˆ—
2. ğŸ§  **è®°å¿†ç³»ç»Ÿ**: çŸ­æœŸï¼ˆä¸Šä¸‹æ–‡ï¼‰+ é•¿æœŸï¼ˆå‘é‡åº“/æ•°æ®åº“ï¼‰
3. ğŸ› ï¸ **å·¥å…·è°ƒç”¨**: APIã€ä»£ç æ‰§è¡Œã€æœç´¢ã€è®¡ç®—å™¨
4. ğŸ”„ **ç¯å¢ƒäº¤äº’**: è§‚å¯Ÿç»“æœ â†’ è°ƒæ•´ç­–ç•¥ â†’ æ‰§è¡Œ
5. ğŸ¤ **å¤šAgentåä½œ**: è§’è‰²åˆ†é…ã€é€šä¿¡ã€åè°ƒ

**vs é™æ€CoT**: CoTåªæ˜¯ä¸€æ¬¡æ€§æ¨ç†é“¾ï¼ŒAgentæ˜¯**æŒç»­äº¤äº’ç³»ç»Ÿ**ã€‚

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ï¼ˆ4æ ¸å¿ƒç»„ä»¶ï¼‰

### 1. Planning (è§„åˆ’)

**é—®é¢˜**: Agentå¦‚ä½•ä»å¤æ‚ä»»åŠ¡ç”Ÿæˆå¯æ‰§è¡Œæ­¥éª¤ï¼Ÿ

**æ–¹æ³•A: Task decomposition (ä»»åŠ¡åˆ†è§£)**
- **é›¶æ ·æœ¬**: 
  ```text
  Task: "å†™ä¸€ç¯‡å…³äºLLMçš„åšå®¢"
  æ­¥éª¤1: ç¡®å®šä¸»é¢˜
  æ­¥éª¤2: æ”¶é›†èµ„æ–™
  æ­¥éª¤3: æ’°å†™è‰ç¨¿
  æ­¥éª¤4: ä¿®è®¢
  ```
- **å°‘æ ·æœ¬** (few-shot): æä¾›ç¤ºä¾‹åˆ†è§£æ¨¡æ¿
- **LLM + å¤–éƒ¨å·¥å…·**: ä½¿ç”¨æœç´¢APIæŸ¥æ‰¾"åšå®¢å†™ä½œæ­¥éª¤"

**æ–¹æ³•B: Plan-and-Solve**
1. å…ˆç”Ÿæˆé«˜å±‚è®¡åˆ’ï¼ˆé«˜å±‚è§„åˆ’ï¼‰
2. é€æ­¥æ‰§è¡Œï¼ŒçŠ¶æ€è¿½è¸ª
3. é‡åˆ°å¤±è´¥æ—¶é‡æ–°è§„åˆ’ï¼ˆreplanï¼‰

**æ–¹æ³•C: Reflection + Self-Critique**
- æ‰§è¡Œåè¯„ä¼°ç»“æœè´¨é‡
- è‡ªæˆ‘æ‰¹è¯„â†’æ”¹è¿›â†’é‡æ–°æ‰§è¡Œ
- ç±»ä¼¼RL but with LLM

**æŒ‘æˆ˜**:
- è§„åˆ’è´¨é‡é«˜åº¦ä¾èµ–LLMèƒ½åŠ›
- é•¿å°¾ä»»åŠ¡éš¾ä»¥é¢„åˆ†è§£
- å®æ—¶é‡è§„åˆ’å¼€é”€å¤§

---

### 2. Memory (è®°å¿†ç³»ç»Ÿ)

**çŸ­æœŸè®°å¿†**: å½“å‰ä¸Šä¸‹æ–‡ï¼ˆæœ‰é™é•¿åº¦ï¼Œå¦‚4K-128K tokensï¼‰

**é•¿æœŸè®°å¿†**: å‘é‡åº“ + æ£€ç´¢ï¼ˆRAGæ¨¡å¼ï¼‰

**è®¾è®¡æ¨¡å¼**:
- **Write** (è®°å¿†å­˜å‚¨):
  - è®°å½•å…³é”®ä¿¡æ¯ï¼ˆç”¨æˆ·åå¥½ã€ä¸­é—´ç»“æœï¼‰
  - æ ¼å¼: JSON, å‘é‡embedding
- **Read** (è®°å¿†æ£€ç´¢):
  - ç›¸ä¼¼åº¦æœç´¢ï¼ˆcosine, dot-productï¼‰
  - å…³é”®è¯è¿‡æ»¤ + å‘é‡å¬å›
  - è¿”å›Top-Kç›¸å…³è®°å¿†

**ç¤ºä¾‹**:
```python
# ç”¨æˆ·è¯´"æˆ‘å–œæ¬¢ç®€æ´çš„åšå®¢"
memory.save(user_pref="concise_style", content="prefers short paragraphs")
# ä¸‹æ¬¡å†™ä½œæ—¶è¯»å–
style = memory.retrieve("concise_style")  # â†’ "short paragraphs"
```

**é«˜çº§**: åˆ†å±‚è®°å¿†ï¼ˆepisodic + semantic + proceduralï¼‰

---

### 3. Tool Use (å·¥å…·ä½¿ç”¨)

**å·¥å…·å®šä¹‰**: ä»»ä½•Agentå¯è°ƒç”¨çš„å¤–éƒ¨å‡½æ•°
- **æœç´¢API** (Google, arXiv, Wikipedia)
- **ä»£ç è§£é‡Šå™¨** (Python REPL)
- **è®¡ç®—å™¨** (mathç²¾ç¡®è¿ç®—)
- **æ•°æ®åº“æŸ¥è¯¢** (SQL)
- **APIè°ƒç”¨** (å¤©æ°”ã€é‚®ä»¶ã€æ—¥å†)

**å…³é”®é—®é¢˜**:
1. **å·¥å…·é€‰æ‹©**: ç»™å®šä»»åŠ¡ï¼Œé€‰å“ªä¸ªå·¥å…·ï¼Ÿ
2. **å‚æ•°ç”Ÿæˆ**: å¦‚ä½•å¡«å……å·¥å…·å‚æ•°ï¼Ÿ
3. **ç»“æœè§£æ**: å¦‚ä½•ç†è§£å·¥å…·è¿”å›ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**: 
- **ReActæ¨¡å¼**: æ¨ç†ï¼ˆThoughtï¼‰â†’ è¡ŒåŠ¨ï¼ˆActionï¼‰â†’ è§‚å¯Ÿï¼ˆObservationï¼‰å¾ªç¯
- **Toolformer** (Meta): å­¦ä¹ ä½•æ—¶/å¦‚ä½•è°ƒç”¨å·¥å…·
- **API-Bank**: å¤§è§„æ¨¡å·¥å…·ä½¿ç”¨benchmark

**ç¤ºä¾‹å¯¹è¯**:
```
Human: ä»Šå¤©åŒ—äº¬å¤©æ°”ï¼Ÿ
Agent Thought: éœ€è¦å¤©æ°”API
Action: call_weather(city="åŒ—äº¬")
Observation: {temp: 5Â°C, humidity: 30%}
Answer: åŒ—äº¬ä»Šå¤©5Â°Cï¼Œå¹²ç‡¥
```

---

### 4. Multi-Agent Systems (å¤šAgentç³»ç»Ÿ)

**åä½œæ¨¡å¼**:
- **è§’è‰²åˆ†é…**: Manager + Worker + Reviewer
- **æ¶ˆæ¯ä¼ é€’**: é˜Ÿåˆ—/äº‹ä»¶æ€»çº¿
- **åè°ƒæœºåˆ¶**: ä¸­å¤®æ§åˆ¶å™¨æˆ–å»ä¸­å¿ƒåŒ–åå•†

**ç»å…¸æ¶æ„**:
1. **MetaGPT**: æ¯ä¸ªAgentæœ‰ç‰¹å®šè§’è‰²ï¼ˆäº§å“ç»ç†ã€å·¥ç¨‹å¸ˆã€æµ‹è¯•ï¼‰
2. **AutoGen**: å¤šAgentå¯¹è¯æ¡†æ¶ï¼ˆHuman + AIï¼‰
3. **CrewAI**: ä»»åŠ¡è·¯ç”±åˆ°ä¸“å®¶Agent

**æŒ‘æˆ˜**:
- å¤æ‚ä»»åŠ¡åˆ†è§£ï¼ˆå¤šçº§ï¼‰
- Agenté—´ä¿¡ä»»ä¸éªŒè¯
- æ­»é”æ£€æµ‹ä¸æ¢å¤

---

## ğŸ”„ å…¸å‹Agentå·¥ä½œæµï¼ˆReActï¼‰

```
1. æ¥æ”¶ä»»åŠ¡: "æŸ¥æ‰¾æœ€æ–°LLMè®ºæ–‡å¹¶æ€»ç»“"
2. æ€è€ƒ: "æˆ‘éœ€è¦æœç´¢arXiv"
3. è¡ŒåŠ¨: search_arxiv(query="LLM 2026")
4. è§‚å¯Ÿ: [è¿”å›10ç¯‡è®ºæ–‡]
5. æ€è€ƒ: "é€‰3ç¯‡ç›¸å…³åº¦é«˜çš„"
6. è¡ŒåŠ¨: filter(papers, criteria="multimodal")
7. è§‚å¯Ÿ: [3ç¯‡è®ºæ–‡]
8. æ€è€ƒ: "é˜…è¯»å¹¶æå–æ‘˜è¦"
9. è¡ŒåŠ¨: read_and_summarize(papers)
10.è§‚å¯Ÿ: [æ‘˜è¦æ–‡æœ¬]
11.å›ç­”: æ€»ç»“å®Œæˆ
```

**å¾ªç¯æ¬¡æ•°**: é€šå¸¸3-10è½®

---

## ğŸ’¡ å¤šAgentæ¶æ„ç¤ºä¾‹ï¼ˆåŸºäºLilian Wengï¼‰

### åœºæ™¯: å…¬å¸æ™ºèƒ½ä½“ï¼ˆä¼ä¸šåº”ç”¨ï¼‰

**Agentè§’è‰²**:
- **Orchestrator**: æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œåˆ†å‘ç»™å­Agent
- **Research Agent**: æ”¶é›†å¸‚åœºæƒ…æŠ¥ã€ç«å“åˆ†æ
- **Analyst Agent**: æ•°æ®åˆ†æã€å¯è§†åŒ–
- **Writer Agent**: ç”ŸæˆæŠ¥å‘Š
- **Reviewer Agent**: æ£€æŸ¥è´¨é‡ã€é€»è¾‘

**æµç¨‹**:
```
User â†’ Orchestrator â†’ Research â†’ Analyst â†’ Writer â†’ Reviewer â†’ Final Report
      (dispatch)      (search)  (data)   (draft)  (check)     (deliver)
```

**é€šä¿¡**: é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRedis/RabbitMQï¼‰æˆ–å…±äº«å†…å­˜

---

## ğŸ› ï¸ å®ç°æ¡†æ¶å¯¹æ¯”

| Framework | æ ¸å¿ƒç‰¹æ€§ | é€‚ç”¨åœºæ™¯ |
|-----------|---------|---------|
| **LangChain** | å·¥å…·é“¾ä¸°å¯Œã€é“¾å¼è°ƒç”¨ | å¿«é€ŸåŸå‹ |
| **LlamaIndex** | RAGä¼˜åŒ–ã€æ•°æ®è¿æ¥ | çŸ¥è¯†åº“Agent |
| **AutoGPT** | è‡ªä¸»å¾ªç¯ã€ä»»åŠ¡åˆ†è§£ | è‡ªåŠ¨åŒ–å·¥ä½œæµ |
| **BabyAGI** | ç›®æ ‡é©±åŠ¨ã€è®°å¿†ç®¡ç† | é•¿æœŸé¡¹ç›® |
| **AutoGen** | å¤šAgentå¯¹è¯ | åä½œåœºæ™¯ |
| **ReAct** (paper) | æ¨ç†-è¡ŒåŠ¨å¾ªç¯ | åŸºç¡€ç ”ç©¶ |
| **CrewAI** | è§’è‰²å®šä¹‰ã€æµç¨‹æ§åˆ¶ | ä¼ä¸šåº”ç”¨ |

---

## ğŸ¯ å¯¹Eè€å¸ˆé¡¹ç›®çš„å¯ç¤º

### 1. å¤šæ¨¡æ€Agentæ¶æ„å‚è€ƒ

**åŸºäºSTEP3 + Lilian Wengçš„æ··åˆè®¾è®¡**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ä»»åŠ¡: "åˆ†æè¿™ä¸ªç•Œé¢å¹¶ç‚¹å‡»æäº¤"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Orchestrator (è§„åˆ’)  â”‚
    â”‚ - åˆ†è§£: è§‚å¯Ÿâ†’ç†è§£â†’ç‚¹å‡» â”‚
    â”‚ - åˆ†é…: Vision Agent â”‚
    â”‚          Action Agentâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Vision Agent (STEP3) â”‚
    â”‚ - å¤šæ¨¡æ€ç†è§£          â”‚
    â”‚ - GUI grounding      â”‚
    â”‚ - è¾“å‡ºç›®æ ‡åæ ‡        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ (åæ ‡)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Action Agent (æ‰§è¡Œ)  â”‚
    â”‚ - è°ƒç”¨æ‰‹æœºtap API    â”‚
    â”‚ - éªŒè¯ç»“æœ           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ åé¦ˆ: æˆåŠŸ/å¤±è´¥       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®**:
- **è§„åˆ’å±‚**: ä»»åŠ¡åˆ†è§£ï¼ˆOrchestratorï¼‰
- **æ„ŸçŸ¥å±‚**: STEP3-VL-10Bï¼ˆå¤šæ¨¡æ€ç†è§£ï¼‰
- **æ‰§è¡Œå±‚**: æ‰‹æœºAPIè°ƒç”¨
- **åé¦ˆç¯**: æˆåŠŸ/å¤±è´¥ â†’ re-plan

---

### 2. è®°å¿†ç³»ç»Ÿè®¾è®¡

**çŸ­æœŸè®°å¿†**: å½“å‰ä¸Šä¸‹æ–‡ï¼ˆSTEP3çš„128K contextè¶³ä»¥ï¼‰

**é•¿æœŸè®°å¿†**:
- ç”¨æˆ·åå¥½ï¼ˆå¦‚"å–œæ¬¢è“è‰²ä¸»é¢˜"ï¼‰
- å¸¸è§ä»»åŠ¡æ¨¡æ¿ï¼ˆ"ç™»å½•æµç¨‹"ï¼‰
- é”™è¯¯æ¡ˆä¾‹ï¼ˆ"ä¸Šæ¬¡ç‚¹å‡»å¤±è´¥çš„ä½ç½®"ï¼‰

**å®ç°**: ChromaDB/FAISS + å®šæœŸæ¸…ç†

---

### 3. å·¥å…·ä½¿ç”¨æ¨¡å¼

**ReActå¾ªç¯åœ¨æ‰‹æœºAgentä¸Šçš„åº”ç”¨**:

```
1. è§‚å¯Ÿ: æˆªå›¾ â†’ STEP3ç†è§£
2. æ€è€ƒ: "æŒ‰é’®åœ¨å³ä¸‹è§’"
3. è¡ŒåŠ¨: tap(x=800, y=1200)
4. è§‚å¯Ÿ: å±å¹•å˜åŒ–ï¼ˆæ–°é¡µé¢ï¼‰
5. æ€è€ƒ: "ç™»å½•æˆåŠŸ"
6. è¡ŒåŠ¨: è¾“å…¥å¯†ç ...
```

**å·¥å…·é›†**:
- tap(x, y)
- swipe(dx, dy)
- type(text)
- wait(seconds)
- get_screenshot()

---

### 4. å¤šAgentåä½œåœ¨ä¼ä¸šåœºæ™¯

**åˆ†å±‚æ¶æ„**:
```
Level 1: é«˜å±‚Orchestrator (GPT-4 level)
        â†“ dispatches
Level 2: é¢†åŸŸä¸“å®¶ (Step3-level)
        - Vision Agent
        - Data Agent
        - Security Agent
        - ...
```

**é€šä¿¡åè®®**:
```json
{
  "sender": "orchestrator",
  "receiver": "vision_agent",
  "message_type": "task",
  "content": {"task": "analyze_screenshot", "image": "base64..."}
}
```

---

## ğŸ”¬ å®éªŒè®¾è®¡å»ºè®®

### Step 1: å•AgentåŸºçº¿ï¼ˆReActï¼‰

ä½¿ç”¨STEP3-VL-10Bä½œä¸ºsingle agentï¼š
```python
agent = ReActAgent(
  model="stepfun-ai/Step3-VL-10B",
  tools=[tap, swipe, type, screenshot],
  max_iterations=10
)

result = agent.run("æ‰“å¼€å¾®ä¿¡å¹¶å‘é€æ¶ˆæ¯")
```

**è¯„ä¼°**: ä»»åŠ¡å®Œæˆç‡ã€æ­¥éª¤æ•°ã€é”™è¯¯æ¢å¤èƒ½åŠ›

---

### Step 2: è®°å¿†å¢å¼º

æ·»åŠ å‘é‡è®°å¿†åº“ï¼š
```python
agent = ReActAgent(
  model="...",
  tools=[...],
  memory=VectorMemory(embedding="text-embedding-ada-002")
)
```

**æµ‹è¯•**: å¤šä¼šè¯å­¦ä¹ ï¼ˆè®°ä½ç”¨æˆ·åå¥½ï¼‰

---

### Step 3: å¤šAgentç³»ç»Ÿ

å¼•å…¥ä¸“é—¨Agentï¼š
```python
orchestrator = OrchestratorAgent()
vision_agent = VisionAgent(model="Step3-VL-10B")
action_agent = ActionAgent()

# åä½œå®Œæˆå¤æ‚ä»»åŠ¡
result = orchestrator.delegate(
  task="é¢„è®¢é…’åº—",
  specialists=[vision_agent, action_agent]
)
```

---

## âš ï¸ æ½œåœ¨é£é™©

1. **è§„åˆ’å¤±è´¥**: ä»»åŠ¡åˆ†è§£ä¸åˆç† â†’ æ­»å¾ªç¯
   - ç¼“è§£: è®¾ç½®æœ€å¤§è¿­ä»£æ¬¡æ•°ã€äººç±»ç›‘ç£ç‚¹
2. **å·¥å…·è¯¯ç”¨**: é”™è¯¯å‚æ•° â†’ ç ´åæ€§æ“ä½œ
   - ç¼“è§£: å·¥å…·schemaéªŒè¯ã€dry-runæ¨¡å¼
3. **è®°å¿†æ±¡æŸ“**: é”™è¯¯è®°å¿†é•¿æœŸå½±å“
   - ç¼“è§£: è®°å¿†TTLã€ç½®ä¿¡åº¦è¯„åˆ†
4. **å¤šAgentå†²çª**: è§’è‰²é‡å æˆ–çŸ›ç›¾æŒ‡ä»¤
   - ç¼“è§£: æƒé™ç³»ç»Ÿã€ä»²è£æœºåˆ¶

---

## ğŸ“Š æ€§èƒ½åŸºçº¿

- **å•Agent ReAct**: ç®€å•ä»»åŠ¡æˆåŠŸç‡ ~70%, å¤æ‚ä»»åŠ¡ ~30%
- **å¤šAgent**: å¤æ‚ä»»åŠ¡æå‡åˆ° ~60%ï¼ˆéœ€ç²¾å¿ƒè®¾è®¡ï¼‰
- **è®°å¿†å¢å¼º**: å¤šä¼šè¯ä»»åŠ¡ +20% æˆåŠŸç‡

**ç›®æ ‡**: æ‰‹æœºç«¯Agentåœ¨5æ­¥å†…å¤æ‚ä»»åŠ¡å®Œæˆç‡ >50%

---

**æ€»ç»“**: Lilian Wengçš„ç³»ç»Ÿæ¡†æ¶ä¸ºAgentç ”ç©¶æä¾›äº†æ¸…æ™°çš„è·¯çº¿å›¾ã€‚ç»“åˆSTEP3çš„è§†è§‰èƒ½åŠ›ï¼Œå¯ä»¥å¿«é€Ÿæ„å»ºå¤šæ¨¡æ€æ‰‹æœºAgentåŸå‹ã€‚

---

*Created: 2026-02-20 12:45 | Quality: 0.88 | TODO: learning-new-id*
